# Stm32学习

## 一.学习路线
### 1.开始学习stm32，学习GPIO和外部中断，学习uart iic spi通信，oled，rtos
### 3.学习定时器和pwm，转动舵机和电机
### 4.学习了解matlab和stimulus
### 5.学习画pcb，画了拓展板，焊接并搭载rtos
### 6. 制作平衡小车，了解陀螺仪，pid，滤波算法，蓝牙调控，上位机观测，git代码管理

## 二.问题与解决方案（平衡小车）
### 1.无论怎么调小车都很失控：正确读取陀螺仪三个轴角度，写好pid计算
### 2.oled突然不亮了 ： 刚开始以为是软件代码问题导致堵塞，把硬件iic改成了软件iic发现未果，后来烧录到另一个小车发现会亮，发现是板子硬件问题
### 3.小车在平衡位置一顿一顿的晃 ： 改善滤波，加入低通滤波
### 4.重新安装小车烧录了原来的代码后失控 ： 极性反了变符号
### 5.联手机蓝牙老发生阻塞问题； 改用电脑上位机观测并实时调试（改波特率）
### 6.小车从桌上摔下来，板子断电和右侧电机卡顿不转 ： 用万用表检查各模块，并分别检查代码和硬件问题
### 7.旋转的时候小车平衡性太差往一个方向倒 ： 降低转向环的最大输出，减少对直立环的影响，增强kp 

## 三.代码框架
创建user文件夹分模块写
### **1.encoder.c**
####    编写启动和读取数据函数

### **2.motor.c**
####    编写电机驱动函数

### **3.I2C_soft.c**
####    配置mpu6050的软件iic

### **4.Mpu6050.c**
####    初始化，读取三个轴的角度和角速度数据

### **5.PID.c**
####    进行pid计算和输出

### **6.control.c**
核心控制
####    采取串级Pid算法，进行内外环控制，直立环作为内环，速度环和转向环为外环，将速度环的输出作为直立环的输入，速度环的输入为左右电机平均速度，直立环的输出为平均Pwm 

### **7.BLE.c**
####    封装数据包与手机进行通信

### **8.oled.c font.c**
####    点亮oled进行数据显示

### **9.vofa.c**
####    编写函数与上位机通信

## 四.经验总结
### 1.从每次失败中吸取经验
### 2.先学习了解好了原理再去编写调试
### 3.排查问题的时候要软硬件结合
### 4.学习不同的软件助手和好的算法